R package developement
================
Junzhe Shao
10/21/2021

Credit to John Muschelli

## Where to start

check your name is available on CRAN, Bioconductor or GitHub

``` r
library(available)
available("ssmimputedemo")
```

## Basic file Introduction in R package:

\~/man/xx.Rd …… R documentation  
\~/DESCRIPTION …….  
sample description file:  
Package: ssmimputedemo  
Type: Package  
Title: SSM Imputation DEMO(Title Case)  
Version: 0.1.0  
Author: Junzhe Shao  
Maintainer: The package maintainer <yourself@somewhere.net>  
Description: More about what it does (maybe more than one line)  
Use four spaces when indenting paragraphs within the Description.  
A demo for SSM Imputation  
License: GPL-3  
Encoding: UTF-8  
LazyData: true

Build -&gt; install and restart

``` r
library(ssmimputedemo)
```

    ## Loading required package: tibble

``` r
?hello
```

## Roxygen

Build -&gt; Configure Build Tools -&gt; Build Tools  
Configure Roxygen -&gt; Check everything  
cran check : –as-cran to be more stable

roxygen file automatically create .Rd file any time we recompile the
package

Code -&gt;insert roxygen skeleton

``` r
#' @title 
#' @description 
#' My hello world function
#' @param x The name of person to say hi to
#'
#' @return The output from  \code{\link{print}}    
#' @export
#'
#' @examples
#' hello("Steve")
#' \dontrun{
#' hello("Steve")}
```

tab auto completion for @\_\_, will create title and description exactly
the same. can link you to outside, examples and function

Build -&gt; clean and rebuild

ℹ Loading ssmimputedemo Warning: The existing ‘hello.Rd’ file was not
generated by roxygen2, and will not be overwritten. Warning: The
existing ‘NAMESPACE’ file was not generated by roxygen2, and will not be
overwritten.

delete these files with default setup Build -&gt; clean and rebuild

export(hello), let the users using hello

check package

creater a new printer funtion, you can add multiple files

## R package usethis

``` r
library(usethis)
#automaticlly create a readme file
use_readme_rmd()
#push to github, set github remote repository
use_git(message = "")
use_github(protocol = "https")
```

really nice to add these RoxygenNote: 7.1.2  
URL: <https://github.com/Junzheshao5959/ssmimputedemo>  
BugReports: <https://github.com/Junzheshao5959/ssmimputedemo/issues>

## Importing and Exporting funcitons

using vignette <https://r-pkgs.org/vignettes.html>

``` r
use_vignette("SSM_vignette")
```

Suggests: knitr, rmarkdown VignetteBuilder: knitr
importFrom(tibble,as\_data\_frame)

automatically add

``` r
use_package("tibble")
```

Depends: tibble

You can use check package to see if there is any function not imported.

## Travis and Continuous Integration

Check changes from timeline

``` r
use_github_actions()
codecov()
```

<https://app.travis-ci.com/github/Junzheshao5959/ssmimputedemo/builds>

## Unit Tests and Local Package Coverage

Let’s do some test

``` r
usethis::use_testthat()
```

    ## ✓ Setting active project to '/Users/junzheshao/Documents/ssmimputedemo'

    ## • Call `use_test()` to initialize a basic test file and open it for editing.

``` r
library(testthat)
```

create a file under \~/test/testthat, like this:

``` r
test_that("test test",{
  set.seed(123)
  res = printer(x = rnorm(5), r = rnorm(5))
  expect_that(nrow(res) ,equals(5) )
})
```

Addins: calculate packge coverage or you can

``` r
covr::package_coverage(type = 'all')
```

    ## ssmimputedemo Coverage: 100.00%

    ## R/hello.R: 100.00%

    ## R/printer.R: 100.00%

## Add some data to our package

``` r
use_data_raw()

set.seed(123)

library(dplyr)
x = rnorm(100)
y = rnorm(100)
sample_data = tibble(x = x, y = y)
  
usethis::use_data(sample_data, compress = "xz")
```

You will have sampe\_data.rda under the \~/data folder

``` r
library(ssmimputedemo)
head(sample_data)
```

    ## # A tibble: 6 × 2
    ##         x       y
    ##     <dbl>   <dbl>
    ## 1 -0.560  -0.710 
    ## 2 -0.230   0.257 
    ## 3  1.56   -0.247 
    ## 4  0.0705 -0.348 
    ## 5  0.129  -0.952 
    ## 6  1.72   -0.0450

``` r
?sample_data
```

you can also create a website by package down.
